<% provide(:title, 'All Patients') %>
<h1>All patients</h1>

<ul class="patients">
  <%# @patients.each do |patient| %>
  <%#= render patient %>
  <%#= render @patients %>
  <%# end %>
</ul>
<% if current_user.admin? %>
<a class="add-patient btn btn-primary" href="/patients/new"><%#= link_to "Doctors", doctors_path %>Add Patient</a>
<% else %>
        <% end %>
<%= will_paginate %>

<div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Phone Number</th>
            <th>Doctor Assigned</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @patients.each do |patient| %>
            <tr>
              <td><%= link_to patient.name, patient %></td>
              <td><%= patient.email %></td>
              <td><%= patient.phone %></td>
              <td>
                <% patient.doctors.each do |doctor| %>
                  <%= link_to doctor.name, doctor %></br>
                <% end %>
                </td>
              <td>
                <%#= edit_link(patient) %>
                <%= link_to "Edit", edit_patient_path(patient) , class: 'btn btn-primary btn-sm' %>
                <%= link_to "View", patient_path(patient) , class: 'btn btn-success btn-sm' %>
                <% if current_user.admin? %>
                <%= link_to "Delete", patient_path(patient), title: 'Delete', class: 'fa fa-trash-alt btn btn-danger btn-sm', method: :delete, data: { confirm: "Are you sure you want to delete this patient #{patient.name}?" } %>
                <% else %>
                <%#= link_to "Can't Delete", patient_path(patient), title: "Can't Delete", class: 'fa fa-trash-alt btn btn-danger btn-sm' %>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <%= will_paginate %>
